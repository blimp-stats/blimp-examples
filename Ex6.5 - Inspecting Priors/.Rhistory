# read data from working directory
imps <- read.table(paste0(getwd(), "/imps.dat"))
names(imps) <- c("imputation","id.l1","id.l2","n1.l1","d1.l1","d2.l1","n2.l1",
"x1.l1","x2.l1","x3.l1","x4.l1","y.l1","d3.l2","x5.l2","x6.l2")
# center predictors
imps$x1.l1.cgm <- imps$x1.l1 - mean(imps$x1.l1)
imps$x4.l1.cgm <- imps$x4.l1 - mean(imps$x4.l1)
imps$d2.l1.cgm <- imps$d2.l1 - mean(imps$d2.l1)
imps$x5.l2.cgm <- imps$x5.l2 - mean(imps$x5.l2)
implist <- mitml::as.mitml.list(split(imps, imps$imputation))
model <- "y.l1 ~ x1.l1.cgm + x4.l1.cgm + d2.l1.cgm + x5.l2.cgm + d3.l2 + (1|school)"
ddf <- c(26,978,978,978,26,26)
results <- with(implist, lme4::lmer(model, REML = T))
mitml::testEstimates(results, extra.pars = T, df.com = ddf)
model <- "y.l1 ~ x1.l1.cgm + x4.l1.cgm + d2.l1.cgm + x5.l2.cgm + d3.l2 + (1|id.l2)"
model <- "y.l1 ~ x1.l1.cgm + x4.l1.cgm + d2.l1.cgm + x5.l2.cgm + d3.l2 + (1 | id.l2)"
ddf <- c(26,978,978,978,26,26)
results <- with(implist, lme4::lmer(model, REML = T))
mitml::testEstimates(results, extra.pars = T, df.com = ddf)
# set working directory
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# read data from working directory
imps <- read.table(paste0(getwd(), "/imps.dat"))
names(imps) <- c("imputation","level1id","level2id","n1.i","d1.i",
"d2.i","n2.i","x1.i","x2.i","x3.i","x4.i",
"y.i","d3.j","x5.j","x6.j")
# center predictors
imps$x1.i.cgm <- imps$x1.i - mean(imps$x1.i)
imps$x4.i.cgm <- imps$x4.i - mean(imps$x4.i)
imps$d2.i.cgm <- imps$d2.i - mean(imps$d2.i)
imps$x5.j.cgm <- imps$x5.j - mean(imps$x5.j)
# analysis and pooling
implist <- mitml::as.mitml.list(split(imps, imps$imputation))
model <- "y.i ~ x1.i.cgm + x4.i.cgm + d2.i.cgm + x5.j.cgm
+ d3.j + (1|level1id)"
ddf <- 26
results <- with(implist, lme4::lmer(model, REML = T))
mitml::testEstimates(results, extra.pars = T, df.com = ddf)
# set working directory
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# read data from working directory
imps <- read.table(paste0(getwd(), "/imps.dat"))
names(imps) <- c("imputation","level1id","level2id","n1.i","d1.i",
"d2.i","n2.i","x1.i","x2.i","x3.i","x4.i",
"y.i","d3.j","x5.j","x6.j")
# center predictors
imps$x1.i.cgm <- imps$x1.i - mean(imps$x1.i)
imps$x4.i.cgm <- imps$x4.i - mean(imps$x4.i)
imps$d2.i.cgm <- imps$d2.i - mean(imps$d2.i)
imps$x5.j.cgm <- imps$x5.j - mean(imps$x5.j)
# analysis and pooling
implist <- mitml::as.mitml.list(split(imps, imps$imputation))
model <- "y.i ~ x1.i.cgm + x4.i.cgm + d2.i.cgm + x5.j.cgm + d3.j + (1|level1id)"
ddf <- 26
results <- with(implist, lme4::lmer(model, REML = T))
mitml::testEstimates(results, extra.pars = T, df.com = ddf)
implist <- mitml::as.mitml.list(split(imps, imps$imputation))
model <- "y.i ~ x1.i.cgm + x4.i.cgm + d2.i.cgm + x5.j.cgm + d3.j + (1|level2id)"
ddf <- 26
results <- with(implist, lme4::lmer(model, REML = T))
mitml::testEstimates(results, extra.pars = T, df.com = ddf)
View(imps)
implist <- mitml::as.mitml.list(split(imps, imps$imputation))
model <- "y.i ~ x1.i.cgm + x4.i.cgm + d2.i.cgm + x5.j.cgm + d3.j + /
(1|level2id)"
ddf <- 23
results <- with(implist, lme4::lmer(model, REML = T))
implist <- mitml::as.mitml.list(split(imps, imps$imputation))
model <- "y.i ~ x1.i.cgm + x4.i.cgm + d2.i.cgm + x5.j.cgm + d3.j + \
(1|level2id)"
ddf <- 23
results <- with(implist, lme4::lmer(model, REML = T))
mitml::testEstimates(results, extra.pars = T, df.com = ddf)
# set working directory
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# read data from working directory
imps <- read.table(paste0(getwd(), "/imps.dat"))
names(imps) <- c("imputation","level1id","level2id","x1.i","x2.i","y.i","x3.i","x4.i",
"d1.j","n1.j","x5.j","x6.j","x7.j","x8.j","x9.j")
# within-cluster (group mean) center sleep quality
imps <- rockchalk::gmc(imps, c("x1.i"), by = c("level2id"), FUN = mean, suffix = c(".meanj", ".cwc"), fulldataframe = T)
max(imps$level2id)
imps$x2.i.cgm <- imps$x2.i - mean(imps$x2.i)
imps$x7.j.cgm <- imps$x7.j - mean(imps$x7.j)
imps$d1.j.cgm <- imps$d1.j - mean(imps$d1.j)
implist <- mitml::as.mitml.list(split(imps, imps$imputation))
model <- "y.i ~ x1.i.cwc + x2.i.cgm + x7.j.cgm + d1.j + (1 + x1.i.cwc|level2id)"
ddf <- 127
results <- with(implist, lme4::lmer(model, REML = T))
mitml::testEstimates(results, extra.pars = T, df.com = ddf)
# set working directory
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# read data from working directory
imps <- read.table(paste0(getwd(), "/imps.dat"))
names(imps) <- c("imputation","level1id","level2id","x1.i","x2.i","y.i","x3.i","x4.i",
"d1.j","n1.j","x5.j","x6.j","x7.j","x8.j","x9.j")
# within-cluster (group mean) center
imps <- rockchalk::gmc(imps, c("x1.i"), by = c("level2id"), FUN = mean,
suffix = c(".meanj", ".cwc"), fulldataframe = T)
# set working directory
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# read data from working directory
imps <- read.table(paste0(getwd(), "/imps.dat"))
names(imps) <- c("imputation","level1id","level2id","x1.i","x2.i","y.i","x3.i","x4.i",
"d1.j","n1.j","x5.j","x6.j","x7.j","x8.j","x9.j",
"y.i[level2id]","y.i$x1.i[level2id]","x1.i.mean[level2id]","x2.i.mean[level2id]",
"y.i.residual")
# within-cluster (group mean) center
plot(density(imps$y.i[level2id]))
plot(density(imps$y.i$x1.i[level2id]))
imps <- read.table(paste0(getwd(), "/imps.dat"))
names(imps) <- c("imputation","level1id","level2id","x1.i","x2.i","y.i","x3.i","x4.i",
"d1.j","n1.j","x5.j","x6.j","x7.j","x8.j","x9.j",
"y.i.level2id.","y.i$x1.i.level2id","x1.i.mean.level2id","x2.i.mean.level2id",
"y.i.residual")
# within-cluster (group mean) center
plot(density(imps$y.i.level2id))
plot(density(imps$y.i$x1.i.level2id))
plot(density(imps$y.i.on.x1.i.level2id))
imps <- read.table(paste0(getwd(), "/imps.dat"))
names(imps) <- c("imputation","level1id","level2id","x1.i","x2.i","y.i","x3.i","x4.i",
"d1.j","n1.j","x5.j","x6.j","x7.j","x8.j","x9.j",
"y.i.level2id.","y.i.on.x1.i.level2id","x1.i.mean.level2id","x2.i.mean.level2id",
"y.i.residual")
plot(density(imps$y.i.on.x1.i.level2id))
plot(density(imps$y.i.level2id))
plot(density(imps$y.i.on.x1.i.level2id))
qqnorm(imps$y.i.level2id); qqline(imps$y.i.level2id)
qqnorm(imps$y.i.on.x1.i.level2id); qqline(imps$y.i.on.x1.i.level2id)
qqnorm(imps$y.i.on.x1.i.level2id, xlim = c(-4,4), ylim = c(-4,4)); qqline(imps$y.i.on.x1.i.level2id)
# qq plots
qqnorm(imps$y.i.level2id); qqline(imps$y.i.level2id)
qqnorm(imps$y.i.on.x1.i.level2id); qqline(imps$y.i.on.x1.i.level2id)
rockchalk::skewness(imps$y.i.level2id)
rockchalk::kurtosis(imps$y.i.level2id)
rockchalk::skewness(imps$y.i.on.x1.i.level2id)
rockchalk::kurtosis(imps$y.i.on.x1.i.level2id
rockchalk::kurtosis(imps$y.i.on.x1.i.level2id)
rockchalk::skewness(imps$y.i.level2id)
rockchalk::kurtosis(imps$y.i.level2id)
rockchalk::skewness(imps$y.i.on.x1.i.level2id)
rockchalk::kurtosis(imps$y.i.on.x1.i.level2id)

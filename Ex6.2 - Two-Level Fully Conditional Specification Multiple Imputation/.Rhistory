# read data from working directory
imps <- read.table(paste0(getwd(), "/imps.dat"))
names(imps) <- c("imputation","id.l1","id.l2","n1.l1","d1.l1","d2.l1","n2.l1",
"x1.l1","x2.l1","x3.l1","x4.l1","y.l1","d3.l2","x5.l2","x6.l2")
# center predictors
imps$x1.l1.cgm <- imps$x1.l1 - mean(imps$x1.l1)
imps$x4.l1.cgm <- imps$x4.l1 - mean(imps$x4.l1)
imps$d2.l1.cgm <- imps$d2.l1 - mean(imps$d2.l1)
imps$x5.l2.cgm <- imps$x5.l2 - mean(imps$x5.l2)
implist <- mitml::as.mitml.list(split(imps, imps$imputation))
model <- "y.l1 ~ x1.l1.cgm + x4.l1.cgm + d2.l1.cgm + x5.l2.cgm + d3.l2 + (1|school)"
ddf <- c(26,978,978,978,26,26)
results <- with(implist, lme4::lmer(model, REML = T))
mitml::testEstimates(results, extra.pars = T, df.com = ddf)
model <- "y.l1 ~ x1.l1.cgm + x4.l1.cgm + d2.l1.cgm + x5.l2.cgm + d3.l2 + (1|id.l2)"
model <- "y.l1 ~ x1.l1.cgm + x4.l1.cgm + d2.l1.cgm + x5.l2.cgm + d3.l2 + (1 | id.l2)"
ddf <- c(26,978,978,978,26,26)
results <- with(implist, lme4::lmer(model, REML = T))
mitml::testEstimates(results, extra.pars = T, df.com = ddf)

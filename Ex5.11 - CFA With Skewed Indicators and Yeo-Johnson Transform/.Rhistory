phi <- matrix(c(1,.338,0,0,.338,1,0,0,0,0,1,0,0,0,0,1), ncol = 4)
round(1 - diag(lambda %*% phi %*% t(lambda)),3)
intlo <- c(
0.896,
0.898,
0.913,
0.919,
0.736,
0.696
)
deplo <- c(
0.854,
0.728,
0.944,
0.939,
0.875,
0.8,
0.8
)
lambda <- cbind(rbind(cbind(deplo, 0), cbind(0, intlo)),0,0)
lambda[2,2] <- .38
lambda[6,3] <- .40
lambda[7,3] <- .40
lambda[1,4] <- .35
lambda[5,4] <- .35
phi <- matrix(c(1,.338,0,0,.338,1,0,0,0,0,1,0,0,0,0,1), ncol = 4)
round(1 - diag(lambda %*% phi %*% t(lambda)),3)
# read data from working directory
imps <- read.table(paste0(getwd(), "/imps.dat"))
names(imps) <- c("imputation","id.l1","id.l2","n1.l1","d1.l1","d2.l1","n2.l1",
"x1.l1","x2.l1","x3.l1","x4.l1","y.l1","d3.l2","x5.l2","x6.l2")
library("mitml")
library("lme4")
sessionInfo()
citation(
)
chis <- c(3,4,5,6,7,8,9)
computeD2 <- function(chis, df){
k <- df
M <- length(chis)
sqrtchi <- sqrt(chis)
ARIV <- (1 + 1/M) * var(sqrtchi)
chimean <- mean(chis)
Tf <- (chimean/k - ((M+1)/(M-1) * ARIV)) / (1 + ARIV)
Tc <- (chimean - ((M+1)/(M-1) * ARIV * k)) / (1 + ARIV)
dfD = k**-(3/M) * (M - 1) * (1 + 1 / ARIV)**2
pF <- 1 - pf(Tf, k, dfD)
pchi <- 1 - pchisq(Tc,k)
results <- c(Tf,ARIV,k,dfD,pF,Tc,pchi)
return(results)
}
computeD2(chis, df)
chis <- c(3,4,5,6,7,8,9)
df <- 2
computeD2 <- function(chis, df){
k <- df
M <- length(chis)
sqrtchi <- sqrt(chis)
ARIV <- (1 + 1/M) * var(sqrtchi)
chimean <- mean(chis)
Tf <- (chimean/k - ((M+1)/(M-1) * ARIV)) / (1 + ARIV)
Tc <- (chimean - ((M+1)/(M-1) * ARIV * k)) / (1 + ARIV)
dfD = k**-(3/M) * (M - 1) * (1 + 1 / ARIV)**2
pF <- 1 - pf(Tf, k, dfD)
pchi <- 1 - pchisq(Tc,k)
results <- c(Tf,ARIV,k,dfD,pF,Tc,pchi)
return(results)
}
computeD2(chis, df)
chis <- c(1,2,3,4,5,1,2,3,4,5)
df <- 2
computeD2 <- function(chis, df){
k <- df
M <- length(chis)
sqrtchi <- sqrt(chis)
ARIV <- (1 + 1/M) * var(sqrtchi)
chimean <- mean(chis)
Tf <- (chimean/k - ((M+1)/(M-1) * ARIV)) / (1 + ARIV)
Tc <- (chimean - ((M+1)/(M-1) * ARIV * k)) / (1 + ARIV)
dfD = k**-(3/M) * (M - 1) * (1 + 1 / ARIV)**2
pF <- 1 - pf(Tf, k, dfD)
pchi <- 1 - pchisq(Tc,k)
testResults <- c(Tf,ARIV,k,dfD,pF,Tc,k,pchi)
labels <- c("F.stat","ARIV","F.df.Num","F.df.Denom","F.pvalue","chi.stat","chi.df","chi.pvalue")
results <- cbind(labels,round(testResults),digits = 3))
return(results)
}
k <- df
M <- length(chis)
sqrtchi <- sqrt(chis)
ARIV <- (1 + 1/M) * var(sqrtchi)
chimean <- mean(chis)
Tf <- (chimean/k - ((M+1)/(M-1) * ARIV)) / (1 + ARIV)
Tc <- (chimean - ((M+1)/(M-1) * ARIV * k)) / (1 + ARIV)
dfD = k**-(3/M) * (M - 1) * (1 + 1 / ARIV)**2
pF <- 1 - pf(Tf, k, dfD)
pchi <- 1 - pchisq(Tc,k)
testResults <- c(Tf,ARIV,k,dfD,pF,Tc,k,pchi)
labels <- c("F.stat","ARIV","F.df.Num","F.df.Denom","F.pvalue","chi.stat","chi.df","chi.pvalue")
results <- cbind(labels,round(testResults),digits = 3))
results <- cbind(labels,round(testResults),digits = 3)
results
testResults <- matrix(c(Tf,ARIV,k,dfD,pF,Tc,k,pchi), ncol = 1)
row.names(testResults) <- c("F.stat","ARIV","F.df.Num","F.df.Denom","F.pvalue","chi.stat","chi.df","chi.pvalue")
testResults
computeD2 <- function(chis, df){
k <- df
M <- length(chis)
sqrtchi <- sqrt(chis)
ARIV <- (1 + 1/M) * var(sqrtchi)
chimean <- mean(chis)
Tf <- (chimean/k - ((M+1)/(M-1) * ARIV)) / (1 + ARIV)
Tc <- (chimean - ((M+1)/(M-1) * ARIV * k)) / (1 + ARIV)
dfD = k**-(3/M) * (M - 1) * (1 + 1 / ARIV)**2
pF <- 1 - pf(Tf, k, dfD)
pchi <- 1 - pchisq(Tc,k)
testResults <- matrix(c(Tf,ARIV,k,dfD,pF,Tc,k,pchi), ncol = 1)
row.names(testResults) <- c("F.stat","ARIV","F.df.Num","F.df.Denom","F.pvalue","chi.stat","chi.df","chi.pvalue")
labels <- c("F.stat","ARIV","F.df.Num","F.df.Denom","F.pvalue","chi.stat","chi.df","chi.pvalue")
return(results)
}
testResults <- computeD2(chis, df)
testResults
testResults <- round(matrix(c(Tf,ARIV,k,dfD,pF,Tc,k,pchi), ncol = 1), digits = 3)
row.names(testResults) <- c("F.stat","ARIV","F.df.Num","F.df.Denom","F.pvalue","chi.stat","chi.df","chi.pvalue")
# labels <- c("F.stat","ARIV","F.df.Num","F.df.Denom","F.pvalue","chi.stat","chi.df","chi.pvalue")
print(testResults)
computeD2 <- function(chis, df){
k <- df
M <- length(chis)
sqrtchi <- sqrt(chis)
ARIV <- (1 + 1/M) * var(sqrtchi)
chimean <- mean(chis)
Tf <- (chimean/k - ((M+1)/(M-1) * ARIV)) / (1 + ARIV)
Tc <- (chimean - ((M+1)/(M-1) * ARIV * k)) / (1 + ARIV)
dfD = k**-(3/M) * (M - 1) * (1 + 1 / ARIV)**2
pF <- 1 - pf(Tf, k, dfD)
pchi <- 1 - pchisq(Tc,k)
testResults <- round(matrix(c(Tf,ARIV,k,dfD,pF,Tc,k,pchi), ncol = 1), digits = 3)
row.names(testResults) <- c("F.stat","ARIV","F.df.Num","F.df.Denom","F.pvalue","chi.stat","chi.df","chi.pvalue")
print(testResults)
}
computeD2(chis, df)
col.names(testResults) <- c("Value")
chis <- c(1,2,3,4,5,1,2,3,4,5)
df <- 2
computeD2 <- function(chis, df){
k <- df
M <- length(chis)
sqrtchi <- sqrt(chis)
ARIV <- (1 + 1/M) * var(sqrtchi)
chimean <- mean(chis)
Tf <- (chimean/k - ((M+1)/(M-1) * ARIV)) / (1 + ARIV)
Tc <- (chimean - ((M+1)/(M-1) * ARIV * k)) / (1 + ARIV)
dfD = k**-(3/M) * (M - 1) * (1 + 1 / ARIV)**2
pF <- 1 - pf(Tf, k, dfD)
pchi <- 1 - pchisq(Tc,k)
testResults <- round(matrix(c(Tf,ARIV,k,dfD,pF,Tc,k,pchi), ncol = 1), digits = 3)
row.names(testResults) <- c("F.stat","ARIV","F.df.Num","F.df.Denom","F.pvalue","chi.stat","chi.df","chi.pvalue")
col.names(testResults) <- c("Value")
print(testResults)
}
computeD2(chis, df)
k <- df
M <- length(chis)
sqrtchi <- sqrt(chis)
ARIV <- (1 + 1/M) * var(sqrtchi)
chimean <- mean(chis)
Tf <- (chimean/k - ((M+1)/(M-1) * ARIV)) / (1 + ARIV)
Tc <- (chimean - ((M+1)/(M-1) * ARIV * k)) / (1 + ARIV)
dfD = k**-(3/M) * (M - 1) * (1 + 1 / ARIV)**2
pF <- 1 - pf(Tf, k, dfD)
pchi <- 1 - pchisq(Tc,k)
testResults <- round(matrix(c(Tf,ARIV,k,dfD,pF,Tc,k,pchi), ncol = 1), digits = 3)
row.names(testResults) <- c("F.stat","ARIV","F.df.Num","F.df.Denom","F.pvalue","chi.stat","chi.df","chi.pvalue")
col.names(testResults) <- c("Value")
testResults <- round(matrix(c(Tf,ARIV,k,dfD,pF,Tc,k,pchi), ncol = 1), digits = 3)
rownames(testResults) <- c("F.stat","ARIV","F.df.Num","F.df.Denom","F.pvalue","chi.stat","chi.df","chi.pvalue")
testResults
colnames(testResults) <- c("Value")
testResults
chis <- c(1,2,3,4,5,1,2,3,4,5)
df <- 2
computeD2 <- function(chis, df){
k <- df
M <- length(chis)
sqrtchi <- sqrt(chis)
ARIV <- (1 + 1/M) * var(sqrtchi)
chimean <- mean(chis)
Tf <- (chimean/k - ((M+1)/(M-1) * ARIV)) / (1 + ARIV)
Tc <- (chimean - ((M+1)/(M-1) * ARIV * k)) / (1 + ARIV)
dfD = k**-(3/M) * (M - 1) * (1 + 1 / ARIV)**2
pF <- 1 - pf(Tf, k, dfD)
pchi <- 1 - pchisq(Tc,k)
testResults <- round(matrix(c(Tf,ARIV,k,dfD,pF,Tc,k,pchi), ncol = 1), digits = 3)
rownames(testResults) <- c("F.stat","ARIV","F.df.Num","F.df.Denom","F.pvalue","chi.stat","chi.df","chi.pvalue")
colnames(testResults) <- c("Value")
print(testResults)
}
computeD2(chis, df)
params = matrix(read.table("~/desktop/estimates.dat"), ncol = 66)
View(params)
View(params)
View(params)
params = read.table("~/desktop/estimates.dat")
View(params)
cov(parameters[12:13,12:13])
cov(params[12:13,12:13])
cov(params[,12:13])
sqrt(diag(cov(params[,12:13])))
colMeans(params[12:13])
cov(params[,12:13])
params = read.table("~/desktop/estimates.dat")
print("point estimates")
colMeans(params[12:13])
print("variance-covariances of coefficients")
cov(params[,12:13])
IQ <- c(110, 112, 98, 95, 100)
IQ
IQ
IQ
dat <- matrix(0, nrow = 5, ncol = 2)
View(dat)
dat <- matrix(c(110, 112, 98, 95, 100, 0, 0, 1, 1, 0), nrow = 5, ncol = 2)
dat
dat.t <- t(dat)
dat.t
dat <- rnorm(1000, 100, 15)
dat
plot(density(dat))
plot(density(dat))
hist(dat)
for(r in 1:10){
print(r)
}
reps <- 100
for(r in 1:reps){
print(r)
}
mean(dat)
reps <- 5
for(r in 1:reps){
dat <- rnorm(20, 100, 15)
dat.mean <- mean(dat)
print(paste0("The mean of sample ", r, " = ", dat.mean))
}
dat.mean
reps <- 5
results <- matrix(0, nows = reps, ncol = 2)
results
results <- matrix(0, now = reps, ncol = 2)
results <- matrix(0, nrow = reps, ncol = 2)
results
reps <- 5
results <- matrix(0, nrow = reps, ncol = 2)
for(r in 1:reps){
dat <- rnorm(20, 100, 15)
dat.mean <- mean(dat)
results[r,1] <- r
results[r,2] <- dat.mean
print(paste0("The mean of sample ", r, " = ", dat.mean))
}
results
reps <- 10000
results <- matrix(0, nrow = reps, ncol = 2)
for(r in 1:reps){
dat <- rnorm(20, 100, 15)
dat.mean <- mean(dat)
results[r,1] <- r
results[r,2] <- dat.mean
# print(paste0("The mean of sample ", r, " = ", dat.mean))
}
View(results)
mean(results)
mean(results[,2])
plot(density(results[,2]))
lines(v = 100)
line(v = 100)
results[1,2]
results[1,]
install.packages(c("bestNormalize", "catchr", "corpcor", "cpp11", "data.table", "desc", "digest", "fda", "future", "future.apply", "gert", "haven", "hms", "ipred", "knitr", "lattice", "lava", "lifecycle", "matrixStats", "mgcv", "mime", "mitml", "msm", "nlme", "openssl", "parallelly", "performance", "pillar", "pkgload", "pls", "psych", "R6", "RcppArmadillo", "RCurl", "readr", "recipes", "rjags", "rlist", "rmarkdown", "rngtools", "sirt", "stringi", "survival", "tibble", "tidyr", "tinytex", "vroom", "waldo", "xfun", "XML"))
# true population values for the simulation
# these values from the null hypothesis
population_mean <- 25
population_sd <- 7
# sample size
sampsize <- 22
# number of samples to draw from the hypothetical population
numsamples <- 10000
# loop that draws samples and analyzes the data the desired number of times
set.seed(90291)
samplemeans <- rep(0, numsamples)
for(s in 1:numsamples){
# draw sample from population
y <- rnorm(sampsize, mean = population_mean, sd = population_sd)
# store the sample mean in element of s
samplemeans[s] <- mean(y)
}
# compute the average of the sample means
# the average of the sample means should equal the true population mean
mean_of_the_means <- round(mean(samplemeans), digits = 4)
print(paste0("The mean of ", numsamples, " sample means = ", mean_of_the_means))
# compute the standard deviation of the sample means
# this is the average sampling error (i.e., the "standard error")!
sd_of_the_means <- round(sd(samplemeans), digits = 3)
print(paste0("The standard deviation of ", numsamples, " sample means (i.e.,standard error) = ", sd_of_the_means))
hist(samplemeans, breaks = 30, main = paste0("Histogram of ", numsamples, " sample means"),
xlab = "Sample Means", ylab = "Frequency", col = "cornflowerblue")
plot(density(samplemeans), main = paste0("Density plot of ", numsamples, " sample means"), xlab = "Sample Means", ylab = "Frequency")
polygon(density(samplemeans), col = "cornflowerblue", border = "black")
R <- matrix(c(1,.3,.3,1), ncol = 2)
S <- diag(c(100,500))
S
C <- S %*% R %*% S
C
cor2cov(R)
corrX <- matrix(c(1,.3,.3,.3,1,.3,.3,.3,1), nrow = 3)
corrX
diag(3)
sdX <- diag(3) * 10
sdX
sigmaX <- sdX %*% corrX %*% sdX
sigmaX
explained.var <- beta %*% sigmaX %*% t(beta)
beta <- c(4,2,1)
explained.var <- beta %*% sigmaX %*% t(beta)
explained.var <- t(beta) %*% sigmaX %*% beta
explained.var
rsquare <- .13
varE <- (explained.var / rsquare) - explained.var
varE
explained.var / (explained.var + varE)
muX <- c(50,50,50)
sqrt(19675.38)
icept <- muY - beta %*% muX
muY <- 500
icept <- muY - beta %*% muX
icept
N <- 100000
Es <- rnorm(N,0,sqrt(varE))
Es
var(Es)
varE
Xs <- rmvnorm(N,muX,sigmaX)
Xs <- mvtnorm::rmvnorm(N,muX,sigmaX)
cov(Xs)
coeffs <- c(icept,beta)
coeffs
Xs.aug <- cbind(1,Xs)
head(Xs.aug)
Y <- Xs.aug %*% coeff + Es
Y <- Xs.aug %*% coeffs + Es
Y
summary(lm(Y ~ Xs[,1] + Xs[,2] + Xs[,3]))
icept
sqrt(varE)
dat <- rchisq(10000000, 5)
rockchalk::skewness(dat); rockchalk::kurtosis(dat)
dat <- rchisq(10000000, 1)
rockchalk::skewness(dat); rockchalk::kurtosis(dat)
dat <- rchisq(10000000, 5)
rockchalk::skewness(dat); rockchalk::kurtosis(dat)
dat <- rchisq(10000000, 10)
rockchalk::skewness(dat); rockchalk::kurtosis(dat)
dat <- rchisq(10000000, 25)
rockchalk::skewness(dat); rockchalk::kurtosis(dat)
dat <- rchisq(10000000, 50)
rockchalk::skewness(dat); rockchalk::kurtosis(dat)
dat <- rchisq(10000000, 2)
rockchalk::skewness(dat); rockchalk::kurtosis(dat)
dat <- rchisq(10000000, 2)
rockchalk::skewness(dat); rockchalk::kurtosis(dat)
dat <- rchisq(10000000, 5)
rockchalk::skewness(dat); rockchalk::kurtosis(dat)
dat <- rchisq(10000000, 10)
rockchalk::skewness(dat); rockchalk::kurtosis(dat)
dat <- rchisq(10000000, 15)
rockchalk::skewness(dat); rockchalk::kurtosis(dat)
nvar <- rnorm(10000000)
lamda <- .25
svar <- VGAM::yeo.johnson(nvar,lambda = lambda, derivative = 0, inverse = T)
lambda <- .25
svar <- VGAM::yeo.johnson(nvar,lambda = lambda, derivative = 0, inverse = T)
rockchalk::skewenss(svar)
rockchalk::skewness(svar)
rockchalk::kurtosis(svar)
svar <- dat$x2
rockchalk::skewness(svar)
rockchalk::kurtosis(svar)
svar <- dat$x2
rockchalk::skewness(svar)
fdir::set()
dat <- read.table("data12.dat")
names(dat) <- c("x1","x2","x3","y1","y2","y3")
svar <- dat$x2
rockchalk::kurtosis(svar)
rockchalk::skewness(svar)
fdir::set()
dat <- read.table("data12.dat")
names(dat) <- c("x1","x2","x3","y1","y2","y3")
dat$x2sk <- VGAM::yeo.johnson(dat$x2,lambda = lambda, derivative = 0, inverse = T)
dat$y1sk <- VGAM::yeo.johnson(dat$y1,lambda = lambda, derivative = 0, inverse = T)
svar <- dat$x2sk
rockchalk::skewness(svar)
rockchalk::kurtosis(svar)
svar <- dat$y1sk
rockchalk::skewness(svar)
rockchalk::kurtosis(svar)
mean(svar)
data12 <- dat[,c("x1","x2sk","x3","y1sk","y2","y3")]
View(data12)
cor(data12)
write.table(data12, "data12.new.dat", row.names = F, col.names = F)
fdir::set()
dat <- read.table("data12.dat")
names(dat) <- c("x1","x2","x3","y1","y2","y3")
# svar <- dat$x2
# nvar <- rnorm(10000000)
lambda <- .25
dat$x2sk <- VGAM::yeo.johnson(dat$x2,lambda = lambda, derivative = 0, inverse = T)
dat$y1sk <- VGAM::yeo.johnson(dat$y1,lambda = lambda, derivative = 0, inverse = T)
svar <- dat$y1sk
rockchalk::skewness(svar)
rockchalk::kurtosis(svar)
mean(svar)
svar <- dat$x2sk
mean(svar)
# load packages
library(semTools)
library(lavaan)
library(mitml)
# set working directory
fdir::set()
# read data from working directory
imps <- read.table("imps.dat")
names(imps) <- c("Imputation","x1","x2","x3","y1","y2","y3","latentx","latenty","x2norm","y1norm")
# specify lavaan model
ylatent <- paste("ylatent =~ x1 + x2norm + x3")
xlatent <- paste("xlatent =~ y1norm + y2 + y3")
model <- c(ylatent,xlatent)
implist <- as.mitml.list(split(imps, imps$Imputation))
analysis <- cfa.mi(model, data = implist, estimator = "ml")
summary(analysis, standardized = T, fit = T)
# load packages
library(semTools)
library(lavaan)
library(mitml)
# fit model with semtools and lavaan
implist <- as.mitml.list(split(imps, imps$Imputation))
analysis <- cfa.mi(model, data = implist, estimator = "ml")
# load packages
library(semTools)
library(lavaan)
library(mitml)
# set working directory
fdir::set()
# read data from working directory
imps <- read.table("imps.dat")
names(imps) <- c("Imputation","x1","x2","x3","y1","y2","y3","latentx","latenty","x2norm","y1norm")
# specify lavaan model
ylatent <- paste("ylatent =~ x1 + x2norm + x3")
xlatent <- paste("xlatent =~ y1norm + y2 + y3")
model <- c(ylatent,xlatent)
# load packages
library(semTools)
library(lavaan)
library(mitml)
fdir::set()
# read data from working directory
imps <- read.table("imps.dat")
names(imps) <- c("Imputation","x1","x2","x3","y1","y2","y3","latentx","latenty","x2norm","y1norm")
# specify lavaan model
ylatent <- paste("ylatent =~ x1 + x2norm + x3")
xlatent <- paste("xlatent =~ y1norm + y2 + y3")
model <- c(ylatent,xlatent)
implist <- as.mitml.list(split(imps, imps$Imputation))
analysis <- cfa.mi(model, data = implist, estimator = "ml")
summary(analysis, standardized = T, fit = T)
# imputation-based modification indices
modindices.mi(analysis, op = c("~~","=~"), minimum.value = 3, sort. = T)
# load packages
library(semTools)
library(lavaan)
library(mitml)
# set working directory
fdir::set()
# read data from working directory
imps <- read.table("imps.dat")
names(imps) <- c("Imputation","x1","x2","x3","y1","y2","y3","latentx","latenty","x2norm","y1norm")
# specify lavaan model
ylatent <- paste("ylatent =~ x1 + x2norm + x3")
xlatent <- paste("xlatent =~ y1norm + y2 + y3")
model <- c(ylatent,xlatent)
# fit model with semtools and lavaan
implist <- as.mitml.list(split(imps, imps$Imputation))
analysis <- cfa.mi(model, data = implist, estimator = "ml")
summary(analysis, standardized = T, fit = T)
# imputation-based modification indices
modindices.mi(analysis, op = c("~~","=~"), minimum.value = 3, sort. = T)
# load packages
library(semTools)
library(lavaan)
library(mitml)
# set working directory
fdir::set()
# read data from working directory
imps <- read.table("imps.dat")
names(imps) <- c("Imputation","x1","x2","x3","y1","y2","y3","latentx","latenty","x2norm","y1norm")
hist(imps$x2)
hist(imps$x2norm)
hist(imps$y1)
hist(imps$y1norm)

# read data from working directory
imps <- read.table(paste0(getwd(), "/imps.dat"))
names(imps) <- c("imputation","id.l1","id.l2","n1.l1","d1.l1","d2.l1","n2.l1",
"x1.l1","x2.l1","x3.l1","x4.l1","y.l1","d3.l2","x5.l2","x6.l2")
# center predictors
imps$x1.l1.cgm <- imps$x1.l1 - mean(imps$x1.l1)
imps$x4.l1.cgm <- imps$x4.l1 - mean(imps$x4.l1)
imps$d2.l1.cgm <- imps$d2.l1 - mean(imps$d2.l1)
imps$x5.l2.cgm <- imps$x5.l2 - mean(imps$x5.l2)
implist <- mitml::as.mitml.list(split(imps, imps$imputation))
model <- "y.l1 ~ x1.l1.cgm + x4.l1.cgm + d2.l1.cgm + x5.l2.cgm + d3.l2 + (1|school)"
ddf <- c(26,978,978,978,26,26)
results <- with(implist, lme4::lmer(model, REML = T))
mitml::testEstimates(results, extra.pars = T, df.com = ddf)
model <- "y.l1 ~ x1.l1.cgm + x4.l1.cgm + d2.l1.cgm + x5.l2.cgm + d3.l2 + (1|id.l2)"
model <- "y.l1 ~ x1.l1.cgm + x4.l1.cgm + d2.l1.cgm + x5.l2.cgm + d3.l2 + (1 | id.l2)"
ddf <- c(26,978,978,978,26,26)
results <- with(implist, lme4::lmer(model, REML = T))
mitml::testEstimates(results, extra.pars = T, df.com = ddf)
# set working directory
fdir::set()
# read data from working directory
imps <- read.table("imps.dat")
names(imps) <- c("imputation",'level1id','level2id','v1_i','v2_i','d1_i','v3_i','x1_i',
'v4_i','v5_i','x2_i','y_i','d2_j','x3_j','v6_j')
# center predictors
imps$x1_i.cgm <- imps$x1_i - mean(imps$x1_i)
imps$x2_i.cgm <- imps$x2_i - mean(imps$x2_i)
imps$d1_i.cgm <- imps$d1_i - mean(imps$d1_i)
imps$x3_j.cgm <- imps$x3_j - mean(imps$x3_j)
# analysis and pooling
implist <- mitml::as.mitml.list(split(imps, imps$imputation))
model <- "y.i ~ x1_i.cgm + x2_i.cgm + d1_i.cgm + x3_j.cgm + d2_j + (1|level2id)"
ddf <- 23
results <- with(implist, lme4::lmer(model, REML = T))
# set working directory
fdir::set()
# read data from working directory
imps <- read.table("imps.dat")
names(imps) <- c("imputation",'level1id','level2id','v1_i','v2_i','d1_i','v3_i','x1_i',
'v4_i','v5_i','x2_i','y_i','d2_j','x3_j','v6_j')
# center predictors
imps$x1_i.cgm <- imps$x1_i - mean(imps$x1_i)
imps$x2_i.cgm <- imps$x2_i - mean(imps$x2_i)
imps$d1_i.cgm <- imps$d1_i - mean(imps$d1_i)
imps$x3_j.cgm <- imps$x3_j - mean(imps$x3_j)
# analysis and pooling
implist <- mitml::as.mitml.list(split(imps, imps$imputation))
model <- "y_i ~ x1_i.cgm + x2_i.cgm + d1_i.cgm + x3_j.cgm + d2_j + (1|level2id)"
ddf <- 23
results <- with(implist, lme4::lmer(model, REML = T))
mitml::testEstimates(results, extra.pars = T, df.com = ddf)
# set working directory
fdir::set()
# read data from working directory
imps <- read.table('imps.dat')
names(imps) <- c('imputation','level1id','level2id','x1_i','x2_i','y_i',
'v1_i','v2_i','d_j','v3_j','v4_j','v5_j','x3_j','v6_j','v7_j',
'y_i.ranicept','x1_i.ranslope','x1_i.mean','x2_i.mean')
# grand center predictors
imps$x1_i.cwc <- imps$x1_i - imps$x1_i.mean
imps$x2_i.cgm <- imps$x2_i - mean(imps$x2_i)
imps$x3_j.cgm <- imps$x3_j - mean(imps$x3_j)
imps$d_j.cgm <- imps$d_j - mean(imps$d_j)
model <- "y_i ~ x1_i.cwc + x2_i.cgm + x3_j.cgm + d_j + (1 + x1_i.cwc|level2id)"
implist <- mitml::as.mitml.list(split(imps, imps$imputation))
model <- "y_i ~ x1_i.cwc + x2_i.cgm + x3_j.cgm + d_j + (1 + x1_i.cwc|level2id)"
ddf <- 127
results <- with(implist, lme4::lmer(model, REML = T))
mitml::testEstimates(results, extra.pars = T, df.com = ddf)
# set working directory
fdir::set()
# read data from working directory
imps <- read.table('imps.dat')
names(imps) <- c('imputation','level1id','level2id','x1_i','x2_i','y_i','v1_i','v2_i',
'd_j','v3_j','v4_j','v5_j','x3_j','v6_j','v7_j',
'y_i.ranicept','x1_i.ranslope','x1_i.mean','x2_i.mean','y_i.residual')
# skewness and kurtosis of residuals
rockchalk::skewness(imps$y_i.ranicept)
rockchalk::kurtosis(imps$y_i.ranicept)
rockchalk::skewness(imps$x1_i.ranslope)
rockchalk::kurtosis(imps$x1_i.ranslope)
rockchalk::skewness(imps$y_i.residual)
rockchalk::kurtosis(imps$y_i.residual)
hist(imps$y_i.residual)
plot(density(imps$y_i.residual))
# plot distribution of level-2 random effects
hist(imps$y.ranicept)
# plot distribution of level-2 random effects
hist(imps$y_i.ranicept)
hist(imps$x1_i.ranslope)
plot(density(imps$y_i.ranicept))
plot(density(imps$x1_i.ranslope))
qqnorm(imps$y_i.ranicept); qqline(imps$y_i.ranicept)
qqnorm(imps$x1_i.ranslope); qqline(imps$x1_i.ranslope)
